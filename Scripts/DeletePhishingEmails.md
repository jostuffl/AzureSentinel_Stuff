# DeletePhishingEmails Runbook / Powershell Script
___


This runbook / powershell script is meant to be paired with the DeletePhishingEmails logic app. 
It takes 3 parameters: **Sender**, **Subject**, **InternetMessageId**
Sender is required, and must be an internal user account so the logic app can gather the internetmessageid(s) of the phishing emails.
Subject and InternetMessageId - You must provide at least one of these for the logic app to work correctly, and optionally you can provide both.

___

```Powershell
param (

[Parameter(Mandatory)]
[string]$Sender,

[Parameter(HelpMessage="Can put either Subject or InternetMessageID, or Both.")]
[string]$Subject,

[Parameter(HelpMessage="Can put either Subject or InternetMessageID, or Both.")]
[String]$InternetMessageId

)

#For the below variable use the url generated by the first step in the 
$Uri = 'YOUR-LOGICAPP-HTTP-REQUEST-URL'


$Body = @{
"Sender"= "$Sender"
"Subject"= "$Subject"
"InternetMessageId"= "$InternetMessageId"
}

Invoke-WebRequest -uri $Uri -Body ($Body|ConvertTo-Json) -ContentType "application/json" -usebasicparsing -Method POST -verbose
```
